<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <title>Echoes of Silence - Prototyp</title>
    <style>
        body { margin: 0; background: #050505; color: white; font-family: sans-serif; overflow: hidden; }
        canvas { display: block; }
        #ui { position: absolute; top: 20px; left: 20px; pointer-events: none; }
        kbd { background: #333; padding: 2px 5px; border-radius: 3px; }
    </style>
</head>
<body>

<div id="ui">
    <h2>Ozveny ticha</h2>
    <p>Pohyb: <kbd>W</kbd><kbd>A</kbd><kbd>S</kbd><kbd>D</kbd> | Echolokácia: <kbd>Medzerník</kbd></p>
</div>

<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// --- Nastavenia hry ---
const player = {
    x: canvas.width / 2,
    y: canvas.height / 2,
    size: 5,
    speed: 3,
    color: '#fff'
};

const keys = {};
const obstacles = [
    { x: 200, y: 150, w: 100, h: 300 },
    { x: 500, y: 100, w: 200, h: 50 },
    { x: 800, y: 400, w: 150, h: 150 },
    { x: 400, y: 500, w: 300, h: 40 }
];

let waves = [];

// --- Ovládanie ---
window.addEventListener('keydown', (e) => {
    keys[e.code] = true;
    if (e.code === 'Space') createWave();
});
window.addEventListener('keyup', (e) => keys[e.code] = false);

function createWave() {
    waves.push({
        x: player.x,
        y: player.y,
        radius: 0,
        maxRadius: 300,
        speed: 5,
        opacity: 1
    });
}

// --- Logika a vykresľovanie ---
function update() {
    if (keys['KeyW']) player.y -= player.speed;
    if (keys['KeyS']) player.y += player.speed;
    if (keys['KeyA']) player.x -= player.speed;
    if (keys['KeyD']) player.x += player.speed;

    // Aktualizácia vĺn
    waves.forEach((wave, index) => {
        wave.radius += wave.speed;
        wave.opacity -= 0.01;
        if (wave.opacity <= 0) waves.splice(index, 1);
    });
}

function draw() {
    // Pozadie (tma)
    ctx.fillStyle = '#000';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Vykreslenie prekážok len vtedy, ak ich zasiahne vlna
    obstacles.forEach(rect => {
        waves.forEach(wave => {
            // Kontrola, či je časť obdĺžnika v dosahu vlny (približná detekcia pre efekt)
            const distToCenter = Math.hypot((rect.x + rect.w/2) - wave.x, (rect.y + rect.h/2) - wave.y);
            
            if (Math.abs(distToCenter - wave.radius) < 20) {
                ctx.strokeStyle = `rgba(0, 255, 255, ${wave.opacity})`;
                ctx.lineWidth = 2;
                ctx.strokeRect(rect.x, rect.y, rect.w, rect.h);
            }
        });
    });

    // Vykreslenie vĺn
    waves.forEach(wave => {
        ctx.beginPath();
        ctx.arc(wave.x, wave.y, wave.radius, 0, Math.PI * 2);
        ctx.strokeStyle = `rgba(255, 255, 255, ${wave.opacity * 0.3})`;
        ctx.stroke();
    });

    // Vykreslenie hráča (stále jemne viditeľný)
    ctx.fillStyle = player.color;
    ctx.beginPath();
    ctx.arc(player.x, player.y, player.size, 0, Math.PI * 2);
    ctx.fill();

    requestAnimationFrame(() => {
        update();
        draw();
    });
}

draw();
</script>
</body>
</html>
